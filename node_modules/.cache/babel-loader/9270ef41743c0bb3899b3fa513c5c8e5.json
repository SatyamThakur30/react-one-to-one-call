{"ast":null,"code":"var _jsxFileName = \"/home/hind/Downloads/react-sample-app/src/pages/Room.js\";\nimport React, { useState, useEffect } from 'react';\nimport { useParams } from \"react-router-dom\";\nimport './room.css';\nlet EnxRtc = window.EnxRtc;\nexport default function Room(props) {\n  let {\n    token\n  } = useParams();\n  let ATList = [];\n  let audio_muted = false;\n  let video_muted = false;\n  let video_type = \"SD\";\n  let room = null;\n  let SubscribedStreamMap = new Map();\n  let localStream,\n      remote_view,\n      sAMute = true,\n      sVMute = true,\n      rAmute = true,\n      rVMute = true;\n  let optionsLocal;\n  let remoteOptions;\n  let isModerator;\n  let VideoSize = {\n    'HD': [320, 180, 1280, 720],\n    'SD': [640, 480, 640, 480],\n    'LD': [80, 45, 640, 360]\n  };\n  let config = {\n    video: true,\n    audio: true,\n    data: true,\n    videoSize: VideoSize[video_type]\n  };\n  optionsLocal = {\n    player: {\n      height: \"150px\",\n      width: \"150px\",\n      minHeight: \"150px\",\n      minWidth: \"150px\"\n    },\n    toolbar: {\n      displayMode: false\n    },\n    resizer: false\n  };\n  remoteOptions = {\n    player: {\n      height: \"100%\",\n      width: \"100%\"\n    },\n    resizer: false,\n    toolbar: {\n      displayMode: false\n    }\n  };\n  useEffect(() => {\n    joinRoom();\n  }, []);\n\n  let enableMuteButton = muteUnmuteBtn => {\n    muteUnmuteBtn.removeAttribute(\"disabled\");\n    muteUnmuteBtn.style.cursor = \"pointer\";\n    muteUnmuteBtn.style.pointerEvents = \"auto\";\n  };\n\n  let joinRoom = () => {\n    console.log('joining the room...');\n    document.querySelector(\"#local_view\").classList.add(\"local_class_peep\");\n    document.querySelector(\"#remote_view\").classList.add(\"remote_class_peep\");\n    let muteUnmuteBtn = document.querySelector(\"#self_vMute\");\n    EnxRtc.Logger.setLogLevel(0);\n    localStream = EnxRtc.joinRoom(token, config, function (success, error) {\n      if (error && error == null) {\n        document.querySelector(\".error_div\").innerHTML = \"Room connection error.\" + error.message;\n      } // if room connects successfully\n\n\n      if (success && success !== null) {\n        //play local view\n        localStream.play(\"self-view\", optionsLocal); // assigning room object to a variable\n\n        room = success.room; // check if the user joined as moderator or participant\n\n        isModerator = room.me.role === \"moderator\" ? true : false;\n        var ownId = success.publishId;\n\n        for (var i = 0; i < success.streams.length; i++) {\n          room.subscribe(success.streams[i]);\n        } // Active talkers handling\n\n\n        room.addEventListener(\"active-talkers-updated\", function (event) {\n          console.log(\"Active Talker List :- \" + JSON.stringify(event));\n          var video_player_len = document.querySelector(\"#call_div\").childNodes;\n          ATList = event.message.activeList;\n\n          if (event.message && event.message !== null && event.message.activeList && event.message.activeList !== null) {\n            if (ATList.length === 0) {\n              document.querySelector(\"#call_div\").innerHTML = \"\";\n              document.querySelector(\".remote-name\").innerText = \"\";\n            }\n\n            if (SubscribedStreamMap.size > 0) {\n              if (video_player_len.length >= 1) {\n                return;\n              } else {\n                for (var stream in room.remoteStreams.getAll()) {\n                  var st = room.remoteStreams.getAll()[stream];\n\n                  for (var j = 0; j < ATList.length; j++) {\n                    if (ATList[j].streamId === st.getID()) {\n                      remote_view = st;\n                      document.querySelector(\".self-name\").innerHTML = room.me.name;\n                      st.play(\"call_div\", remoteOptions);\n                      document.querySelector(\".remote-name\").innerHTML = ATList[j].name;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }); // room recording start  notification\n\n        room.addEventListener(\"room-record-on\", function () {\n          document.querySelector(\"#rec_notification\").style.display = 'block';\n        }); // room recording stop  notification\n\n        room.addEventListener(\"room-record-off\", function () {\n          document.querySelector(\"#rec_notification\").style.display = 'none';\n        });\n        room.addEventListener(\"stream-subscribed\", function (streamEvent) {\n          if (streamEvent.stream.getID() !== ownId) {\n            SubscribedStreamMap.set(streamEvent.stream.getID(), streamEvent.stream);\n          }\n        }); // user disconnection notification\n\n        room.addEventListener(\"user-disconnected\", function (streamEvent) {\n          document.querySelector(\"#call_div\").innerHTML = \"\";\n          document.querySelector(\".remote-name\").innerText = \"\";\n        }); // room disconnected notification\n\n        room.addEventListener(\"room-disconnected\", function (streamEvent) {\n          window.location.href = \"/\";\n        });\n      }\n    }); // self stream audio mute/unmute  function\n\n    document.querySelector(\"#self_aMute\").addEventListener('click', function (e) {\n      if (audio_muted) {\n        if (room.mute) {\n          console.log(\"Your audio is muted by moderator\");\n        } else {\n          localStream.unmuteAudio(function (arg) {\n            document.querySelector(\"#self_aMute\").classList.remove(\"fa-microphone-slash\");\n            document.querySelector(\"#self_aMute\").classList.add(\"fa-microphone\");\n            audio_muted = false;\n          });\n        }\n      } else {\n        localStream.muteAudio(function (arg) {\n          document.querySelector(\"#self_aMute\").classList.remove(\"fa-microphone\");\n          document.querySelector(\"#self_aMute\").classList.add(\"fa-microphone-slash\");\n          audio_muted = true;\n        });\n      }\n    });\n    document.querySelector(\"#disconnect_call\").addEventListener(\"click\", function () {\n      room.disconnect();\n    });\n    document.querySelector('#mute_video').addEventListener('click', function () {\n      muteUnmuteBtn.style.cursor = \"wait\";\n      muteUnmuteBtn.style.pointerEvents = \"none\";\n      muteUnmuteBtn.disabled = true;\n      muteUnmuteBtn.setAttribute(\"disabled\", \"disabled\");\n\n      if (video_muted) {\n        localStream.unmuteVideo(function (res) {\n          if (res.result === 0) {\n            document.querySelector(\"#self_vMute\").classList.remove(\"fa-video-slash\");\n            document.querySelector(\"#self_vMute\").classList.add(\"fa-video\");\n            video_muted = false;\n            enableMuteButton(muteUnmuteBtn);\n          } else if (res.result === 1140) {\n            console.error(res.error);\n            enableMuteButton(muteUnmuteBtn);\n          }\n        });\n      } else {\n        localStream.muteVideo(function (res) {\n          if (res.result === 0) {\n            document.querySelector(\"#self_vMute\").classList.remove(\"fa-video\");\n            document.querySelector(\"#self_vMute\").classList.add(\"fa-video-slash\");\n            video_muted = true;\n            enableMuteButton(muteUnmuteBtn);\n          } else if (res.result === 1140) {\n            enableMuteButton(muteUnmuteBtn);\n          }\n        });\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"layout\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"overlay\",\n    style: {\n      'display': 'none'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"loader\",\n    style: {\n      \"width\": \"50px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"./img/loading.gif\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row p-0 m-0\",\n    id: \"call_container_div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"local_class_peep\",\n    id: \"local_view\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"self-view\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"self-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 29\n    }\n  }, \"Local User\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"remote_class_peep\",\n    id: \"remote_view\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"call_div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"show_stream_div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"remote-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 29\n    }\n  }, \"Remote User\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"toolbar-buttons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"tools\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mute-icon\",\n    id: \"mute_audio\",\n    title: \"Mute/Unmute Audio\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-microphone\",\n    id: \"self_aMute\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 37\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"video-mute-icon\",\n    id: \"mute_video\",\n    title: \"Mute/Unmute Video\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-video\",\n    id: \"self_vMute\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 37\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"video-mute-icon end-call\",\n    title: \"End Call\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-phone fa-fw CBicon\",\n    id: \"disconnect_call\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 37\n    }\n  }))))))));\n}","map":{"version":3,"sources":["/home/hind/Downloads/react-sample-app/src/pages/Room.js"],"names":["React","useState","useEffect","useParams","EnxRtc","window","Room","props","token","ATList","audio_muted","video_muted","video_type","room","SubscribedStreamMap","Map","localStream","remote_view","sAMute","sVMute","rAmute","rVMute","optionsLocal","remoteOptions","isModerator","VideoSize","config","video","audio","data","videoSize","player","height","width","minHeight","minWidth","toolbar","displayMode","resizer","joinRoom","enableMuteButton","muteUnmuteBtn","removeAttribute","style","cursor","pointerEvents","console","log","document","querySelector","classList","add","Logger","setLogLevel","success","error","innerHTML","message","play","me","role","ownId","publishId","i","streams","length","subscribe","addEventListener","event","JSON","stringify","video_player_len","childNodes","activeList","innerText","size","stream","remoteStreams","getAll","st","j","streamId","getID","name","display","streamEvent","set","location","href","e","mute","unmuteAudio","arg","remove","muteAudio","disconnect","disabled","setAttribute","unmuteVideo","res","result","muteVideo"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n    useParams\n} from \"react-router-dom\";\nimport './room.css'\nlet EnxRtc = window.EnxRtc;\n\nexport default function Room(props) {\n    let { token } = useParams();\n    let ATList = [];\n    let audio_muted = false;\n    let video_muted = false;\n    let video_type = \"SD\";\n\n    let room = null;\n    let SubscribedStreamMap = new Map();\n    let localStream,\n        remote_view,\n        sAMute = true,\n        sVMute = true,\n        rAmute = true,\n        rVMute = true;\n\n    let optionsLocal;\n    let remoteOptions;\n    let isModerator;\n    let VideoSize = {\n        'HD': [320, 180, 1280, 720],\n        'SD': [640, 480, 640, 480],\n        'LD': [80, 45, 640, 360]\n    };\n    let config = {\n        video: true,\n        audio: true,\n        data: true,\n        videoSize: VideoSize[video_type],\n    };\n\n    optionsLocal = {\n        player: {\n            height: \"150px\",\n            width: \"150px\",\n            minHeight: \"150px\",\n            minWidth: \"150px\",\n        },\n        toolbar: {\n            displayMode: false,\n        },\n        resizer: false,\n    };\n    remoteOptions = {\n        player: {\n            height: \"100%\",\n            width: \"100%\",\n        },\n        resizer: false,\n        toolbar: {\n            displayMode: false,\n        },\n    };\n\n    useEffect(() => {\n        joinRoom()\n    }, []);\n\n\n    let enableMuteButton = (muteUnmuteBtn) => {\n        muteUnmuteBtn.removeAttribute(\"disabled\");\n        muteUnmuteBtn.style.cursor = \"pointer\";\n        muteUnmuteBtn.style.pointerEvents = \"auto\";\n    }\n\n\n    let joinRoom = () => {\n        console.log('joining the room...');\n        document.querySelector(\"#local_view\").classList.add(\"local_class_peep\");\n        document.querySelector(\"#remote_view\").classList.add(\"remote_class_peep\");\n        let muteUnmuteBtn = document.querySelector(\"#self_vMute\");\n        EnxRtc.Logger.setLogLevel(0);\n        localStream = EnxRtc.joinRoom(token, config, function (success, error) {\n\n            if (error && error == null) {\n                document.querySelector(\".error_div\").innerHTML = \"Room connection error.\" + error.message;\n            }\n            // if room connects successfully\n            if (success && success !== null) {\n\n                //play local view\n                localStream.play(\"self-view\", optionsLocal);\n\n                // assigning room object to a variable\n                room = success.room;\n                // check if the user joined as moderator or participant\n                isModerator = room.me.role === \"moderator\" ? true : false;\n                var ownId = success.publishId;\n                for (var i = 0; i < success.streams.length; i++) {\n                    room.subscribe(success.streams[i]);\n                }\n                // Active talkers handling\n                room.addEventListener(\"active-talkers-updated\", function (event) {\n                    console.log(\"Active Talker List :- \" + JSON.stringify(event));\n                    var video_player_len = document.querySelector(\"#call_div\").childNodes;\n\n                    ATList = event.message.activeList;\n\n                    if (\n                        event.message &&\n                        event.message !== null &&\n                        event.message.activeList &&\n                        event.message.activeList !== null\n                    ) {\n                        if (ATList.length === 0) {\n                            document.querySelector(\"#call_div\").innerHTML = \"\";\n                            document.querySelector(\".remote-name\").innerText = \"\";\n                        }\n                        if (SubscribedStreamMap.size > 0) {\n\n                            if (video_player_len.length >= 1) {\n                                return;\n                            } else {\n                                for (var stream in room.remoteStreams.getAll()) {\n                                    var st = room.remoteStreams.getAll()[stream];\n                                    for (var j = 0; j < ATList.length; j++) {\n                                        if (ATList[j].streamId === st.getID()) {\n                                            remote_view = st;\n                                            document.querySelector(\".self-name\").innerHTML = room.me.name;\n                                            st.play(\"call_div\", remoteOptions);\n                                            document.querySelector(\".remote-name\").innerHTML = ATList[j].name;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n\n                // room recording start  notification\n                room.addEventListener(\"room-record-on\", function () {\n                    document.querySelector(\"#rec_notification\").style.display = 'block';\n                });\n                // room recording stop  notification\n                room.addEventListener(\"room-record-off\", function () {\n                    document.querySelector(\"#rec_notification\").style.display = 'none';\n                });\n\n                room.addEventListener(\"stream-subscribed\", function (streamEvent) {\n                    if (streamEvent.stream.getID() !== ownId) {\n                        SubscribedStreamMap.set(\n                            streamEvent.stream.getID(),\n                            streamEvent.stream\n                        );\n                    }\n                });\n\n\n                // user disconnection notification\n                room.addEventListener(\"user-disconnected\", function (streamEvent) {\n                    document.querySelector(\"#call_div\").innerHTML = \"\";\n                    document.querySelector(\".remote-name\").innerText = \"\";\n                });\n                // room disconnected notification\n                room.addEventListener(\"room-disconnected\", function (streamEvent) {\n                    window.location.href = \"/\";\n                });\n            }\n        });\n\n        // self stream audio mute/unmute  function\n        document.querySelector(\"#self_aMute\").addEventListener('click', function (e) {\n            if (audio_muted) {\n                if (room.mute) {\n                    console.log(\"Your audio is muted by moderator\");\n                } else {\n                    localStream.unmuteAudio(function (arg) {\n                        document.querySelector(\"#self_aMute\").classList.remove(\"fa-microphone-slash\");\n                        document.querySelector(\"#self_aMute\").classList.add(\"fa-microphone\");\n                        audio_muted = false;\n                    });\n                }\n            } else {\n                localStream.muteAudio(function (arg) {\n                    document.querySelector(\"#self_aMute\").classList.remove(\"fa-microphone\");\n                    document.querySelector(\"#self_aMute\").classList.add(\"fa-microphone-slash\");\n                    audio_muted = true;\n                });\n            }\n        });\n\n        document.querySelector(\"#disconnect_call\").addEventListener(\"click\", function () {\n            room.disconnect();\n        });\n\n        document.querySelector('#mute_video').addEventListener('click', function () {\n            muteUnmuteBtn.style.cursor = \"wait\";\n            muteUnmuteBtn.style.pointerEvents = \"none\";\n            muteUnmuteBtn.disabled = true;\n            muteUnmuteBtn.setAttribute(\"disabled\", \"disabled\");\n\n            if (video_muted) {\n                localStream.unmuteVideo(function (res) {\n                    if (res.result === 0) {\n                        document.querySelector(\"#self_vMute\").classList.remove(\"fa-video-slash\");\n                        document.querySelector(\"#self_vMute\").classList.add(\"fa-video\");\n                        video_muted = false;\n                        enableMuteButton(muteUnmuteBtn);\n                    } else if (res.result === 1140) {\n                        console.error(res.error);\n                        enableMuteButton(muteUnmuteBtn);\n                    }\n                });\n            } else {\n                localStream.muteVideo(function (res) {\n                    if (res.result === 0) {\n                        document.querySelector(\"#self_vMute\").classList.remove(\"fa-video\");\n                        document.querySelector(\"#self_vMute\").classList.add(\"fa-video-slash\");\n                        video_muted = true;\n                        enableMuteButton(muteUnmuteBtn);\n                    } else if (res.result === 1140) {\n                        enableMuteButton(muteUnmuteBtn);\n                    }\n                });\n            }\n        });\n\n    }\n\n    return (\n        <div>\n            <div className=\"layout\">\n                <div id=\"overlay\" style={{ 'display': 'none' }}>\n                    <div className=\"loader\" style={{ \"width\": \"50px\" }}>\n                        <img src=\"./img/loading.gif\" alt=\"\" />\n                    </div>\n                </div>\n\n                <div className=\"container\" >\n                    <div className=\"row p-0 m-0\" id=\"call_container_div\">\n\n                        <div className=\"local_class_peep\" id=\"local_view\">\n                            <div id=\"self-view\"></div>\n                            <div className=\"self-name\">Local User</div>\n                        </div>\n\n                        <div className=\"remote_class_peep\" id=\"remote_view\">\n                            <div id=\"call_div\"></div>\n                            <div id=\"show_stream_div\"></div>\n                            <div className=\"remote-name\">Remote User</div>\n                        </div>\n\n                        <div className=\"toolbar-buttons\">\n                            <div className=\"tools\">\n                                <div className=\"mute-icon\" id=\"mute_audio\" title=\"Mute/Unmute Audio\">\n                                    <i className=\"fa fa-microphone\" id=\"self_aMute\"></i>\n                                </div>\n                                <div className=\"video-mute-icon\" id=\"mute_video\" title=\"Mute/Unmute Video\">\n                                    <i className=\"fa fa-video\" id=\"self_vMute\"></i>\n                                </div>\n                                {/* <div className=\"video-mute-icon\" id=\"share_screen_btn\" title=\"Start Share\">\n                                    <i className=\"fa fa-desktop fa-fw SSicon\"></i>\n                                </div> */}\n                                {/* <div className=\"video-mute-icon\" id=\"toggle_chat\" title=\"Chat\">\n                                    <i className=\"fas fa-comment-dots fa-fw CBicon\" ></i>\n                                    <span className=\"tag tag-danger top\" id=\"chat-tag\">&nbsp;</span>\n                                </div> */}\n                                <div className=\"video-mute-icon end-call\" title=\"End Call\">\n                                    <i className=\"fas fa-phone fa-fw CBicon\" id=\"disconnect_call\"></i>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    )\n}\n\n\n\n"]},"metadata":{},"sourceType":"module"}